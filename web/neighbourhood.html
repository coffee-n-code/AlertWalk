<!DOCTYPE html>
<html>
<head title="Which neighbourhood are you in?"</head>
<meta charset="utf8">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.js"></script>
<script language="JavaScript">

function point_in_poly(x, y, poly)
{
    var polySides = poly.length;
    var i;
    var j=poly.length-1;
    var oddNodes = false;

    for (i=0; i<polySides; i++)
    {
        if ((poly[i][1]< y && poly[j][1]>=y
        ||   poly[j][1]< y && poly[i][1]>=y)
        &&  (poly[i][0]<=x || poly[j][0]<=x))
        {
            oddNodes^=(poly[i][0]+(y-poly[i][1])/(poly[j][1]-poly[i][1])*(poly[j][0]-poly[i][0])<x);
        }
        j=i;
    }

    return oddNodes;
} 

function determine_neighbourhood(lat, lon)
{
    var foo = $.getJSON("boundaries.json", function(obj) {
        var ks = Object.keys(obj);
        for (i = 0; i < ks.length; i++)
        {
            way = obj[ks[i]];
            name = way[0];
            poly = way[1];
            if (point_in_poly(lat, lon, poly))
            {
                alert(name);
            }
        }
        alert("that's all");
    });
}
</script>
<body>
<div id="foo">Some text here.</div>
Lon: <input id="lon" type="text" value="-79.4059994"><br>
Lat: <input id="lat" type="text" value="43.6781619"><br>
<button onclick="determine_neighbourhood(parseFloat(lon.value), parseFloat(lat.value))">which neighbourhood</button>
</body>
</html>
